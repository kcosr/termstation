{
  "environment": "prod",
  "listeners": {
    "http": { "enabled": true, "host": "127.0.0.1", "port": 6624 },
    "socket": {
      "enabled": true,
      "chmod": "0600",
      "unlink_stale": true
    }
  },
  "log_level": "DEBUG",
  "auth_enabled": true,
  "cors_origins": ["*"],
  "default_username": "termstation",
  "cors_credentials": true,
  "websocket": {
    "ping_interval_ms": 30000,
    "ping_timeout_ms": 10000,
    "debug_ws_stdin": false,
    "debug_ws_stdout": false
  },
  "terminal": {
    "default_shell": "/bin/bash",
    "default_working_dir": "~",
    "default_cols": 80,
    "default_rows": 24,
    "max_sessions": 200,
    "session_timeout_seconds": 3600,
    "cleanup_interval_seconds": 300,
    "max_buffer_size": 10000,
    "output_chunk_size": 4096
  },
  "logging": {
    "level": "DEBUG",
    "format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  },
  "data_dir": "$HOME/.termstation/data",
  "sessions_base_url": "http://localhost:6625",
  "sessions_api_base_url": "http://localhost:6624/api",
  "container_sessions_api_base_url": "http://host.containers.internal:6624/api/",
  "container_use_socket_adapter": true,
  "template_vars": {
    "branch_cache_dir": "repocache"
  },
  "containers": {
    "runtime": "podman",
    "preserve_template_env_vars_for_login": false,
    "add_hosts": [
    ]
  },
  "stdin_injection": {
    "send_focus_in": false,
    "send_focus_out": false,
    "max_messages_per_session": 10000,
    "default_simulate_typing": true,
    "default_typing_delay_ms": 0,
    "default_delay_ms": 1000
  },
  "scheduled_input": {
    "max_messages_per_session": 1000
  },
  "session_activity": {
    "inactive_after_ms": 1000,
    "min_active_marker_bytes": 32
  },
  "stop_inputs": {
    "grace_ms": 10000,
    "session_start_grace_ms": 15000
  },
  "session_history": {
    "view_mode": "html",
    "keep_raw_log": true,
    "pty_to_html_path": "$HOME/.termstation/files/pty-to-html"
  },
  "features": {
    "workspace_service_enabled": true
  },
  "forges": {
    "GitHub": {
      "enabled": true,
      "type": "github",
      "host": "github.com",
      "ssh_url": "git@github.com:{repo}",
      "ssh_identity_file": "$HOME/.ssh/termstation",
      "https_url": "https://github.com/{repo}",
      "default_protocol": "ssh",
      "repo_pattern": "^(?:https?://github\\.com/|git@github\\.com:|)([^/]+/[^/\\.]+?)(?:\\.git)?$",
      "list_repos": "gh repo list --json owner,name --jq 'sort_by(.name)[] | \"\\(.owner.login)/\\(.name)\"'",
      "list_branches": "gh api repos/{repo}/branches --jq 'sort_by(.commit.committer.date) | reverse | .[] | .name'",
      "issue_url": "https://github.com/{repo}/issues/{issue_id}",
      "repo_url": "https://github.com/{repo}"
    },
    "Gitea": {
      "enabled": false,
      "type": "gitea",
      "host": "gitea",
      "ssh_url": "git@gitea:{repo}",
      "ssh_identity_file": "$HOME/.ssh/termstation",
      "https_url": "https://gitea/{repo}",
      "default_protocol": "https",
      "repo_pattern": "^(?:https?://gitea/|git@gitea:|)([^/]+/[^/\\.]+?)(?:\\.git)?$",
      "list_repos": "tea repo ls --login tsagent --output simple | awk '{print $1\"/\"$2}'",
      "list_branches": "tea branches --repo {repo} --output simple --login tsagent | egrep -v 'name.*protected' | awk '{print $1}'",
      "issue_url": "https://gitea/{repo}/issues/{issue_id}",
      "repo_url": "https://gitea/{repo}"
    },
    "GitLab": {
      "enabled": false,
      "type": "gitlab",
      "host": "gitlab",
      "ssh_url": "git@gitlab:{repo}",
      "ssh_identity_file": "$HOME/.ssh/termstation",
      "https_url": "https://gitlab/{repo}",
      "default_protocol": "ssh",
      "repo_pattern": "^(?:https?://gitlab/|git@gitlab:|)(.+?)(?:\\.git)?$",
      "list_repos": "glab repo list --all | awk '{print $1}' | sort",
      "list_branches": "glab api projects/$(echo '{repo}' | sed 's/\\//%2F/g')/repository/branches --jq '.[].name'",
      "issue_url": "https://gitlab/{repo}/-/issues/{issue_id}",
      "repo_url": "https://gitlab/{repo}"
    }
  }
}
